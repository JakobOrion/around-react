(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(9),i=n.n(o),s=(n(14),n(8)),c=n(2),l=n.p+"static/media/around_us_logo.4e8e0a1d.svg",u=n(0);var d=function(e){var t=e.logo;return Object(u.jsx)("header",{className:"header",children:Object(u.jsx)("img",{className:"logo",src:t,alt:"Around the U.S. logo"})})},f=Object(a.createContext)();var p=function(e){var t=e.card,n=e.onCardClick,r=e.onCardLike,o=e.onDeleteClick,i=Object(a.useContext)(f),s=t.owner._id===i._id,c=t.likes.some((function(e){return e._id===i._id}));return Object(u.jsxs)("li",{className:"photo-card",children:[Object(u.jsx)("button",{type:"button","aria-label":"Delete",className:"photo-card__delete-button",onClick:function(){o(t)},hidden:!s}),Object(u.jsx)("img",{className:"photo-card__image",src:t.link,alt:t.name,onClick:function(){n(t)}}),Object(u.jsxs)("div",{className:"photo-card__info",children:[Object(u.jsx)("h2",{className:"photo-card__title",children:t.name}),Object(u.jsx)("button",{type:"button","aria-label":"Like",className:"photo-card__heart ".concat(c&&"photo-card__heart_active"),onClick:function(){r(t)}}),Object(u.jsx)("div",{className:"photo-card__likes",children:t.likes.length})]})]})};var b=function(e){var t=Object(a.useContext)(f),n=e.onEditAvatar,r=e.onEditProfile,o=e.onAddPlace,i=e.cards,s=e.onCardClick,c=e.onCardLike,l=e.onDeleteClick;return Object(u.jsxs)("main",{className:"content",children:[Object(u.jsxs)("section",{className:"profile",children:[Object(u.jsxs)("div",{className:"profile__avatar-container",children:[Object(u.jsx)("img",{className:"profile__avatar",src:t.avatar,alt:t.name}),Object(u.jsx)("button",{type:"button","aria-label":"Edit Profile Picture",className:"profile__avatar-edit",onClick:n})]}),Object(u.jsxs)("div",{className:"profile__info",children:[Object(u.jsx)("div",{className:"profile__name-container",children:Object(u.jsx)("h1",{className:"profile__name-text",children:t.name})}),Object(u.jsx)("button",{type:"button","aria-label":"Edit Profile",className:"profile__edit",onClick:r}),Object(u.jsx)("p",{className:"profile__description",children:t.about})]}),Object(u.jsx)("button",{type:"button","aria-label":"Add Photo Card",className:"profile__add",onClick:o})]}),Object(u.jsx)("section",{className:"photo-cards",children:Object(u.jsx)("ul",{className:"photo-cards__group",children:i.map((function(e){return Object(u.jsx)(p,{card:e,onCardClick:s,onCardLike:c,onDeleteClick:l},e._id)}))})})]})};var h=function(){return Object(u.jsx)("footer",{className:"footer",children:Object(u.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Around The U.S."})})};var j=function(e){var t=e.card,n=e.isOpen,a=e.onClose;return Object(u.jsx)("div",{className:"popup popup_type_image ".concat(n&&"popup_opened"),onClick:a,children:Object(u.jsxs)("div",{className:"popup__container popup__container_figure",children:[Object(u.jsx)("button",{type:"button","aria-label":"Close",className:"popup__close"}),Object(u.jsxs)("figure",{className:"popup__figure",children:[Object(u.jsx)("img",{className:"popup__image",src:t&&t.link,alt:t.name}),Object(u.jsx)("figcaption",{className:"popup__image-title",children:t.name})]})]})})};var m=function(e){var t=e.name,n=e.title,a=e.children,r=e.buttonText,o=e.isOpen,i=e.isValid,s=e.isLoading,c=e.onClose,l=e.onSubmit;return Object(u.jsx)("div",{className:"popup popup_type_".concat(t," ").concat(o&&"popup_opened"),onClick:c,children:Object(u.jsxs)("div",{className:"popup__container",children:[Object(u.jsx)("h3",{className:"popup__title",children:n}),Object(u.jsx)("button",{type:"button","aria-label":"Close",className:"popup__close"}),Object(u.jsxs)("form",{className:"popup__form",name:t,onSubmit:l,children:[a,Object(u.jsx)("button",{type:"submit",name:r,className:"form__submit ".concat(!i&&"form__submit_disabled"),disabled:!i||"",children:s?"Saving...":r})]})]})})};var _=function(e){var t=e.isOpen,n=e.isLoading,r=e.onClose,o=e.onUpdateUser,i=Object(a.useContext)(f),s=Object(a.useState)(""),l=Object(c.a)(s,2),d=l[0],p=l[1],b=Object(a.useState)(""),h=Object(c.a)(b,2),j=h[0],_=h[1],O=Object(a.useState)(!0),v=Object(c.a)(O,2),g=v[0];return v[1],Object(a.useEffect)((function(){p(i.name),_(i.about)}),[i]),Object(u.jsxs)(m,{name:"edit-profile",title:"Edit profile",buttonText:"Save",isOpen:t,isValid:g,isLoading:n,onClose:r,onSubmit:function(e){e.preventDefault(),o({name:d,about:j})},children:[Object(u.jsx)("input",{"aria-label":"Name",type:"text",className:"form__input form__input_type_name",name:"name",value:d||"",onChange:function(e){p(e.target.value)},placeholder:"Name",minLength:"2",maxLength:"40","aria-required":"true",required:!0}),Object(u.jsx)("span",{className:"form__error","aria-live":"polite"}),Object(u.jsx)("input",{"aria-label":"About me",type:"text",className:"form__input form__input_type_description",name:"about",value:j||"",onChange:function(e){_(e.target.value)},placeholder:"About me",minLength:"2",maxLength:"200","aria-required":"true",required:!0}),Object(u.jsx)("span",{className:"form__error","aria-live":"polite"})]})};var O=function(e){var t=e.isOpen,n=e.isLoading,r=e.onClose,o=e.onUpdateAvatar,i=Object(a.useRef)(),s=Object(a.useState)(!1),l=Object(c.a)(s,2),d=l[0];return l[1],Object(u.jsxs)(m,{name:"edit-avatar",title:"Change profile picture",buttonText:"Save",isOpen:t,isValid:d,isLoading:n,onClose:r,onSubmit:function(e){e.preventDefault(),o(i.current.value)},onUpdateAvatar:o,children:[Object(u.jsx)("input",{ref:i,"aria-label":"Image URL",type:"url",className:"form__input form__input_type_url",name:"avatar",placeholder:"Image link","aria-required":"true",required:!0}),Object(u.jsx)("span",{className:"form__error","aria-live":"polite"})]})};var v=function(e){var t=e.isOpen,n=e.isLoading,r=e.onClose,o=e.onAddPlace,i=Object(a.useState)(""),s=Object(c.a)(i,2),l=s[0],d=s[1],f=Object(a.useState)(""),p=Object(c.a)(f,2),b=p[0],h=p[1],j=Object(a.useState)(!1),_=Object(c.a)(j,2),O=_[0];return _[1],Object(u.jsxs)(m,{name:"add-card",title:"New place",buttonText:"Create",isOpen:t,isValid:O,isLoading:n,onClose:r,onSubmit:function(e){e.preventDefault(),o({name:l,link:b})},onAddPlace:o,children:[Object(u.jsx)("input",{"aria-label":"Title",type:"text",className:"form__input form__input_type_card-title",name:"name",value:l||"",onChange:function(e){d(e.target.value)},placeholder:"Title",minLength:"1",maxLength:"30","aria-required":"true",required:!0}),Object(u.jsx)("span",{className:"form__error","aria-live":"polite"}),Object(u.jsx)("input",{"aria-label":"Image URL",type:"url",className:"form__input form__input_type_url",name:"link",value:b||"",onChange:function(e){h(e.target.value)},placeholder:"Image link","aria-required":"true",required:!0}),Object(u.jsx)("span",{className:"form__error","aria-live":"polite"})]})};var g=function(e){var t=e.card,n=e.isOpen,r=e.isLoading,o=e.onClose,i=e.onConfirmDelete,s=Object(a.useState)(!0),l=Object(c.a)(s,2),d=l[0];return l[1],Object(u.jsx)(m,{name:"delete-card",title:"Are you sure?",buttonText:"Yes",isOpen:n,isValid:d,isLoading:r,onClose:o,onSubmit:function(e){e.preventDefault(),i(t)}})};var x=function(e){var t=Object(a.useState)(!1),n=Object(c.a)(t,2),r=n[0],o=n[1];return r&&o(!1),Object(a.useEffect)((function(){function t(t){t.which===e&&o(!0)}return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}),[e]),r},C=n(5),k=n(6),y=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(C.a)(this,e),this._baseUrl=n,this._headers=a}return Object(k.a)(e,[{key:"getUserInfo",value:function(){return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"getCardList",value:function(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"getAppInfo",value:function(){return Promise.all([this.getUserInfo(),this.getCardList()])}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"removeCard",value:function(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"addLike",value:function(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"removeLike",value:function(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.addLike(e):this.removeLike(e)}},{key:"setProfilePicture",value:function(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)})).catch((function(e){return console.log(e)}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-7",headers:{authorization:"7c54637c-526f-4047-8439-3339585d598e","Content-Type":"application/json"}}),N=function(){function e(t,n){Object(C.a)(this,e),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._form=n}return Object(k.a)(e,[{key:"_showErrorMessage",value:function(e){var t=e.nextElementSibling;t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}},{key:"_hideErrorMessage",value:function(e){var t=e.nextElementSibling;t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideErrorMessage(e):this._showErrorMessage(e,e.validationMessage)}},{key:"_toggleButtonState",value:function(e,t){e.every((function(e){return e.validity.valid}))?(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled")):(t.classList.add(this._inactiveButtonClass),t.setAttribute("disabled"," "))}},{key:"_setEventListeners",value:function(){var e=this,t=Array.from(this._form.querySelectorAll(this._inputSelector)),n=this._form.querySelector(this._submitButtonSelector);t.forEach((function(a){a.addEventListener("input",(function(){e._checkInputValidity(a),e._toggleButtonState(t,n)}))}))}},{key:"enableValidation",value:function(){this._form.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}]),e}();var S=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!1),i=Object(c.a)(o,2),p=i[0],m=i[1],C=Object(a.useState)(!1),k=Object(c.a)(C,2),S=k[0],L=k[1],E=Object(a.useState)(!1),P=Object(c.a)(E,2),U=P[0],A=P[1],T=Object(a.useState)(!1),w=Object(c.a)(T,2),D=w[0],I=w[1],q=Object(a.useState)(!1),B=Object(c.a)(q,2),V=B[0],M=B[1],J=Object(a.useState)(""),F=Object(c.a)(J,2),R=F[0],H=F[1],z=Object(a.useState)(""),Y=Object(c.a)(z,2),G=Y[0],K=Y[1],Q=Object(a.useState)([]),W=Object(c.a)(Q,2),X=W[0],Z=W[1],$=x(27),ee={formSelector:".popup__form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"form__submit_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"};function te(e){!e.target.classList.contains("popup__close")&&e.target.closest(".popup__container")||ne()}function ne(){r(!1),m(!1),L(!1),A(!1),I(!1),M(!1)}return Object(s.a)(document.querySelectorAll(".popup__form")).forEach((function(e){new N(ee,e).enableValidation()})),Object(a.useEffect)((function(){y.getAppInfo().then((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];K(n),Z(a)})).catch((function(e){console.log(e)}))}),[]),Object(u.jsx)(f.Provider,{value:G,children:Object(u.jsxs)("div",{className:"page",children:[$&&ne(),Object(u.jsxs)("div",{className:"page__container",children:[Object(u.jsx)(d,{logo:l}),Object(u.jsx)(b,{onEditAvatar:function(){r(!0)},onEditProfile:function(){m(!0)},cards:X,onAddPlace:function(){L(!0)},onCardClick:function(e){H(e),I(!0)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===G._id}));y.changeLikeCardStatus(e._id,!t).then((function(t){var n=X.map((function(n){return n._id===e._id?t:n}));Z(n)})).catch((function(e){console.log(e)}))},onDeleteClick:function(e){H(e),A(!0)}}),Object(u.jsx)(h,{})]}),Object(u.jsx)(O,{isOpen:n,isLoading:V,onClose:te,onUpdateAvatar:function(e){M(!0),y.setProfilePicture(e).then((function(e){K(e)})).catch((function(e){console.log(e)})).finally((function(){return ne()}))}}),Object(u.jsx)(_,{isOpen:p,isLoading:V,onClose:te,onUpdateUser:function(e){var t=e.name,n=e.about;M(!0),y.setUserInfo({name:t,about:n}).then((function(e){K(e)})).catch((function(e){console.log(e)})).finally((function(){return ne()}))}}),Object(u.jsx)(v,{isOpen:S,isLoading:V,onClose:te,onAddPlace:function(e){var t=e.name,n=e.link;M(!0),y.addCard({name:t,link:n}).then((function(e){Z([e].concat(Object(s.a)(X)))})).catch((function(e){console.log(e)})).finally((function(){return ne()}))}}),Object(u.jsx)(g,{card:R,isOpen:U,isLoading:V,onClose:te,onConfirmDelete:function(e){M(!0),y.removeCard(e._id).then((function(){var t=X.filter((function(t){return t._id!==e._id}));Z(t)})).catch((function(e){console.log(e)})).finally((function(){return ne()}))}}),Object(u.jsx)(j,{card:R,isOpen:D,onClose:te})]})})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))};i.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(S,{})}),document.getElementById("root")),L()}},[[16,1,2]]]);
//# sourceMappingURL=main.9d005d6a.chunk.js.map